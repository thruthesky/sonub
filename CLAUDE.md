Sonub (sonub.com) 웹사이트 개발 가이드라인 및 규칙

- 이 문서는 Sonub 웹사이트 개발 시 반드시 준수해야 할 가이드라인과 규칙을 명시합니다.
- 모든 개발자는 이 문서를 숙지하고 준수해야 합니다.
- 표준 워크플로우는 예외 없이 반드시 따라야 합니다.

# 표준 워크플로우

- [ ] **필수 문서 검토**: 개발자가 개발 작업을 요청할 때, AI는 반드시:
  - [ ] **즉시 docs/**/\*.md 내의 관련 문서를 검색하고 식별\*\*
  - [ ] **작업을 시작하기 전에 관련 문서 파일 목록을 개발자에게 제시**
  - [ ] **기존 패턴, 규칙 및 요구사항을 이해하기 위해 이 문서들을 읽고 분석**
  - [ ] **일관성을 보장하기 위해 개발하는 동안 이 문서들을 참조**
  - [ ] AI는 관련 문서를 검토하고 제시하지 않고 개발을 시작하는 것이 **엄격히 금지**됩니다
- [ ] 이슈 생성: 작업을 시작하기 전에 git 커밋 메시지 규칙을 따르는 이슈를 생성합니다.
- [ ] **파일 인코딩 요구사항 - UTF-8 필수**:
  - [ ] **🔥🔥🔥 최강력 규칙: 모든 파일은 반드시 UTF-8 인코딩으로 저장해야 합니다 🔥🔥🔥**
  - [ ] **모든 문서 파일(\*.md)은 반드시 BOM 없는 UTF-8 인코딩으로 저장**
  - [ ] **모든 소스 코드 파일(_.php, _.js, \*.css)은 반드시 BOM 없는 UTF-8 인코딩으로 저장**
  - [ ] **파일 생성/수정 시 편집기의 인코딩 설정을 반드시 UTF-8로 확인**
  - [ ] **절대 금지**: EUC-KR, CP949, ISO-8859-1 등 다른 인코딩 사용 절대 금지
  - [ ] **위반 시**: 한글이 깨지고(예: 문서 → �8), Git 충돌 발생, 웹사이트 오류 발생
- [ ] **언어 요구사항 - 한국어만 사용**:
  - [ ] **모든 문서 내용(\*.md 파일)은 반드시 한국어로 작성**
  - [ ] **모든 소스 코드 주석은 반드시 한국어로 작성**
    - [ ] PHP, JavaScript, CSS 및 기타 모든 소스 코드의 주석은 한국어로 작성
    - [ ] 마크다운 문서 내 코드 예제의 주석도 한국어로 작성
    - [ ] 함수/메서드 문서화(PHPDoc, JSDoc 등)는 한국어로 작성
  - [ ] **모든 사용자 대면 텍스트 및 UI 요소는 한국어로 작성**
  - [ ] **예외사항**: 코드 자체(변수명, 함수명, 클래스명), 기술 용어, 파일 경로, 라이브러리/프레임워크 코드는 영문 사용 가능
  - [ ] **코드 예제**: 문서나 응답에서 코드 예제를 제공할 때 모든 주석과 설명 텍스트는 한국어로 작성
- [ ] 디자인 작업 시 Bootstrap을 사용해야 합니다.
  - [ ] **라이트 모드만 지원**: Sonub 웹사이트는 라이트 모드만 지원합니다. 다크 모드 기능을 절대 구현하지 마세요.
  - [ ] 항상 Bootstrap의 기본 색상 또는 Bootstrap의 기본 색상 변수를 최대한 사용하세요.
  - [ ] 꼭 필요한 경우가 아니면 커스텀 색상, HEX 코드, 색상 단어 코드 사용을 피하세요.
- [ ] **JavaScript 프레임워크 - Vue.js 3.x**:
  - [ ] Sonub는 PHP MPA(Multi-Page Application) 방식으로 Vue.js 3.x를 CDN을 통해 사용합니다
  - [ ] Vue.js는 모든 페이지에 CDN을 통해 자동으로 로드됩니다 - 수동으로 추가하지 마세요
  - [ ] 각 페이지에서 `const { createApp } = Vue;`를 사용하여 Vue 앱을 생성하세요
  - [ ] **MPA 방식의 장점**: 페이지 이동 시 이벤트 리스너와 Vue 인스턴스가 자동으로 정리됩니다
  - [ ] **정리 작업 불필요**: SPA와 달리 `beforeUnmount`에서 이벤트 리스너를 수동으로 해제할 필요가 없습니다
  - [ ] 각 페이지의 Vue 인스턴스는 완전히 독립적입니다
  - [ ] 복잡한 라우팅이나 상태 관리 라이브러리 없이 간단한 구조를 유지하세요
- [ ] 문서(\*.md) 및 목차 관리
  - [ ] _.md 파일이나 docs/\*\*/_.md 파일을 편집할 때 문서 상단에 목차(ToC)를 반드시 추가해야 합니다.
  - [ ] 문서 구조가 변경될 때마다(섹션 추가, 제거, 이름 변경) 목차를 업데이트해야 합니다.
  - [ ] 목차는 문서의 모든 주요 제목(##)과 부제목(###)을 반영해야 합니다.
  - [ ] 목차를 실제 콘텐츠와 항상 동기화 상태로 유지하세요.
- [ ] PHP 단위 테스트 가이드라인
  - [ ] **🔥🔥🔥 최강력 규칙: 모든 테스트 파일, 임시 파일, 검증 파일은 반드시 `./tests` 폴더 아래에 저장해야 합니다 🔥🔥🔥**
  - [ ] **절대 금지**: 테스트 관련 파일을 프로젝트 루트나 `lib`, `src` 등 다른 폴더에 저장하는 것은 절대 금지
  - [ ] **위반 시**: 프로젝트 구조 오염, 운영 코드와 테스트 코드 혼재, Git 관리 어려움
  - [ ] 모든 PHP 단위 테스트는 외부 테스트 프레임워크 없이 순수 PHP로 작성해야 합니다.
  - [ ] 테스트 파일은 소스 코드와 동일한 구조로 `tests` 디렉토리에 저장해야 합니다.
  - [ ] 테스트 파일 이름은 `.test.php`로 끝나야 합니다 (예: `db.php` 테스트를 위한 `db.test.php`).
  - [ ] 각 테스트 파일은 PHP 명령어로 독립적으로 실행 가능해야 합니다: `php tests/db/db.test.php`
  - [ ] 간단한 단언문과 명확한 출력 메시지를 사용하여 테스트 결과를 표시하세요.
  - [ ] **테스트 파일 저장 위치 예시**:
    - [ ] ✅ 올바른 위치: `tests/db/db.connection.test.php`
    - [ ] ✅ 올바른 위치: `tests/user/user.crud.test.php`
    - [ ] ✅ 올바른 위치: `tests/temp/verify_api.php`
    - [ ] ❌ 잘못된 위치: `db.test.php` (루트 폴더)
    - [ ] ❌ 잘못된 위치: `lib/db/db.test.php` (소스 코드 폴더)
    - [ ] ❌ 잘못된 위치: `temp.php` (루트 폴더)
  - [ ] **테스트 코드 작성 시 필수 사항**:
    - [ ] 모든 테스트 파일 맨 위에 반드시 `include '../init.php'` 추가 (상대 경로는 테스트 파일 위치에 따라 조정)
    - [ ] init.php를 포함하면 모든 라이브러리, 함수, DB 설정 등을 즉시 사용 가능
    - [ ] init.php는 ROOT_DIR 정의 및 etc/includes.php 로드를 자동으로 처리
  - [ ] **테스트 실행 방법**:
    - [ ] 프로젝트 루트 폴더에서 실행: `php tests/db/db.connection.test.php`
    - [ ] 개발자 컴퓨터에서는 `is_dev_computer()` 함수가 true를 반환하여 자동으로 개발 DB 설정 사용
    - [ ] DB 접속 흐름: `is_dev_computer()` → `etc/includes.php` → `etc/config/db.dev.config.php`
    - [ ] 운영 서버에서는 `is_dev_computer()` 함수가 false를 반환하여 `etc/config/db.config.php` 사용
- [ ] **데이터베이스 개발 가이드라인 - 최강력 필수 준수**
  - [ ] **🔥🔥🔥 최강력 규칙: 모든 데이터는 MariaDB에 저장해야 합니다 🔥🔥🔥**
  - [ ] **🔥🔥🔥 최강력 규칙: 데이터베이스 작업 시 반드시 `docs/database.md` 문서를 먼저 읽어야 합니다 🔥🔥🔥**
  - [ ] **절대 준수**: 모든 데이터베이스 쿼리는 `lib/db/db.php`의 쿼리 빌더를 사용해야 합니다
  - [ ] **절대 금지**: 직접 SQL 문자열을 작성하거나 mysqli를 직접 사용하는 것은 절대 금지 (복잡한 쿼리 제외)
  - [ ] **데이터베이스 작업 전 필수 확인 사항**:
    - [ ] `docs/database.md` 문서를 읽고 쿼리 빌더 사용법 확인
    - [ ] `lib/db/db.php`의 메서드 예제 확인
    - [ ] 비슷한 기능의 기존 코드가 있는지 검색
  - [ ] **PHP 함수 작성 시 DB 입출력 규칙**:
    - [ ] 모든 SELECT 쿼리: `db()->select()->from()->where()->get()` 패턴 사용
    - [ ] 모든 INSERT 쿼리: `db()->insert($data)->into($table)` 패턴 사용
    - [ ] 모든 UPDATE 쿼리: `db()->update($data)->table($table)->where()->execute()` 패턴 사용
    - [ ] 모든 DELETE 쿼리: `db()->delete()->from($table)->where()->execute()` 패턴 사용
    - [ ] 플레이스홀더(?)를 사용하여 SQL 인젝션 방지
  - [ ] **데이터베이스 작업 예시**:
    - [ ] ✅ 올바른 방법: `db()->select('*')->from('users')->where('id = ?', [$id])->first()`
    - [ ] ✅ 올바른 방법: `db()->insert(['name' => $name, 'email' => $email])->into('users')`
    - [ ] ❌ 잘못된 방법: `mysqli_query($conn, "SELECT * FROM users WHERE id = $id")`
    - [ ] ❌ 잘못된 방법: 직접 SQL 문자열 작성 (복잡한 쿼리 제외)
  - [ ] **사용자, 게시판, 댓글 등 모든 데이터 입출력**:
    - [ ] 사용자 데이터: `users` 테이블 사용
    - [ ] 게시글 데이터: `posts` 테이블 사용
    - [ ] 댓글 데이터: `comments` 테이블 사용
    - [ ] 모든 데이터 조회/생성/수정/삭제 시 `db()` 쿼리 빌더 사용
  - [ ] **복잡한 쿼리의 경우**:
    - [ ] JOIN, GROUP BY, HAVING 등이 필요한 경우에만 `db()->query()` 사용
    - [ ] 그 외에는 반드시 쿼리 빌더 메서드 사용
  - [ ] **위반 시**: 코드 리뷰 거부, SQL 인젝션 취약점 발생, 데이터 일관성 문제
- [ ] **다국어 번역 개발 가이드라인 - 필수 준수**
  - [ ] **언어 번역 관련 작업을 요청받으면 반드시 `docs/translation.md`의 Standard Workflow를 따라야 합니다**
  - [ ] **절대 준수**: 모든 언어 번역은 각 PHP 파일 하단에 `inject_[php_file_name]_language()` 로컬 함수를 정의해야 합니다
  - [ ] 함수 내부에서 `t()->inject(...)` 함수를 통해 다국어 번역 텍스트를 주입해야 합니다
  - [ ] 예시: `index.php` 파일에서는 맨 아래에 `inject_index_language()` 함수를 정의하고, 파일 맨 위에서 이 함수를 호출하여 번역 텍스트를 주입합니다
  - [ ] **위반 금지**: 이 워크플로우를 따르지 않는 번역 구현은 절대 금지됩니다
  - [ ] 번역 관련 작업 시작 전 반드시 `docs/translation.md` 문서를 읽고 이해해야 합니다

## UTF-8 인코딩 필수 규칙

**🔥🔥🔥 최강력 경고: 모든 문서와 소스 코드는 반드시 UTF-8 인코딩으로 작성해야 합니다 🔥🔥🔥**

### UTF-8 인코딩 규칙

- **✅ 필수**: 모든 문서(\*.md) 파일은 **반드시 UTF-8 인코딩**으로 저장
- **✅ 필수**: 모든 소스 코드(_.php, _.js, \*.css) 파일은 **반드시 UTF-8 인코딩**으로 저장
- **✅ 필수**: BOM(Byte Order Mark) 없는 UTF-8 사용
- **✅ 필수**: 파일 생성 시 편집기의 인코딩 설정을 UTF-8로 지정
- **❌ 금지**: EUC-KR, CP949, ISO-8859-1 등 다른 인코딩 사용 절대 금지
- **❌ 금지**: ASCII만 지원하는 에디터 사용 금지

### 인코딩 확인 방법

**macOS/Linux:**

```bash
# 파일 인코딩 확인
file -I docs/api.md

# 올바른 출력: charset=utf-8
```

**VSCode 설정:**

```json
{
  "files.encoding": "utf8",
  "files.autoGuessEncoding": false
}
```

### 위반 시 결과

- 한글이 깨져서 표시됨 (예: 문서 → �8)
- 파일을 읽을 수 없음
- Git에서 충돌 발생
- 웹사이트에서 한글이 제대로 표시되지 않음

**⚠️ 모든 파일 생성 및 수정 시 반드시 UTF-8 인코딩을 확인하세요! ⚠️**

---
