---
name: sonub
version: 1.0.0
description: Firebase Realtime Database κµ¬μ΅° κ°€μ΄λ“ λ¬Έμ„μ SED μ‚¬μ–‘
author: JaeHo Song
email: thruthesky@gmail.com
homepage: https://github.com/thruthesky/
funding: ""
license: GPL-3.0
dependencies: []
---

- [Firebase Realtime Database κµ¬μ΅° κ°€μ΄λ“](#firebase-realtime-database-κµ¬μ΅°-κ°€μ΄λ“)
  - [μ›ν¬ν”λ΅μ°](#μ›ν¬ν”λ΅μ°)
    - [π“‹ λ¬Έμ„μ λ²”μ„](#-λ¬Έμ„μ-λ²”μ„)
    - [π”€ ν΄λΌμ΄μ–ΈνΈμ™€ λ°±μ—”λ“μ λ°μ΄ν„° μ±…μ„ κµ¬λ¶„](#-ν΄λΌμ΄μ–ΈνΈμ™€-λ°±μ—”λ“μ-λ°μ΄ν„°-μ±…μ„-κµ¬λ¶„)
    - [ν΄λΌμ΄μ–ΈνΈμ™€ λ°±μ—”λ“μ μ—­ν•  λ¶„λ¦¬](#ν΄λΌμ΄μ–ΈνΈμ™€-λ°±μ—”λ“μ-μ—­ν• -λ¶„λ¦¬)
  - [κ°μ”](#κ°μ”)
  - [λ°μ΄ν„°λ² μ΄μ¤ μ „μ²΄ κµ¬μ΅°](#λ°μ΄ν„°λ² μ΄μ¤-μ „μ²΄-κµ¬μ΅°)
  - [μ‚¬μ©μ μ •λ³΄ (users)](#μ‚¬μ©μ-μ •λ³΄-users)
    - [μ‚¬μ©μ Realtime Database λ°μ΄ν„° κµ¬μ΅°](#μ‚¬μ©μ-realtime-database-λ°μ΄ν„°-κµ¬μ΅°)
    - [ν•„λ“ μ„¤λ…](#ν•„λ“-μ„¤λ…)
    - [ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—­ν•  λ¶„λ¦¬](#ν΄λΌμ΄μ–ΈνΈμ„λ²„-μ—­ν• -λ¶„λ¦¬)
    - [β οΈ μ¤‘μ”: Firebase Auth vs RTDB ν•„λ“](#οΈ-μ¤‘μ”-firebase-auth-vs-rtdb-ν•„λ“)
    - [κ΄€λ ¨ κ°€μ΄λ“](#κ΄€λ ¨-κ°€μ΄λ“)
  - [μ‚¬μ©μ μ†μ„± λ¶„λ¦¬ (user-props)](#μ‚¬μ©μ-μ†μ„±-λ¶„λ¦¬-user-props)
    - [λ°μ΄ν„° κµ¬μ΅°](#λ°μ΄ν„°-κµ¬μ΅°)
    - [ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—­ν•  λ¶„λ¦¬](#ν΄λΌμ΄μ–ΈνΈμ„λ²„-μ—­ν• -λ¶„λ¦¬-1)
    - [κ΄€λ ¨ κ°€μ΄λ“](#κ΄€λ ¨-κ°€μ΄λ“-1)
  - [μΉκµ¬ κ΄€κ³„ (friends, followers, following)](#μΉκµ¬-κ΄€κ³„-friends-followers-following)
    - [λ°μ΄ν„° κµ¬μ΅°](#λ°μ΄ν„°-κµ¬μ΅°-2)
    - [μ„¤λ…](#μ„¤λ…)
    - [ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—­ν•  λ¶„λ¦¬](#ν΄λΌμ΄μ–ΈνΈμ„λ²„-μ—­ν• -λ¶„λ¦¬-2)
    - [κ΄€λ ¨ κ°€μ΄λ“](#κ΄€λ ¨-κ°€μ΄λ“-2)
  - [μ£Όμ” μ„¤κ³„ μ›μΉ™](#μ£Όμ”-μ„¤κ³„-μ›μΉ™)
    - [1. Flat Style κµ¬μ΅°](#1-flat-style-κµ¬μ΅°)
    - [2. μ†μ„± λ¶„λ¦¬](#2-μ†μ„±-λ¶„λ¦¬)
    - [3. Cloud Functions ν™μ©](#3-cloud-functions-ν™μ©)
    - [4. λ³΄μ• κ·μΉ™](#4-λ³΄μ•-κ·μΉ™)
  - [μ£Όμμ‚¬ν•­](#μ£Όμμ‚¬ν•­)
    - [Firebase Auth vs RTDB ν•„λ“λ… μ°¨μ΄](#firebase-auth-vs-rtdb-ν•„λ“λ…-μ°¨μ΄)
  - [κ΄€λ ¨ κ°€μ΄λ“ λ¬Έμ„](#κ΄€λ ¨-κ°€μ΄λ“-λ¬Έμ„)
  - [μ°Έκ³  μλ£](#μ°Έκ³ -μλ£)


## Overview
- μ΄ λ¬Έμ„λ” "Firebase Realtime Database κµ¬μ΅° κ°€μ΄λ“"μ— λ€ν• μ„Έλ¶€ μ‚¬μ–‘μ„ μ •λ¦¬ν•λ©°, κΈ°μ΅΄ λ‚΄μ©μ„ κ·Έλ€λ΅ μ μ§€ν• μ±„ SED κµ¬μ΅°μ— λ§μ¶° μ κ³µν•©λ‹λ‹¤.

## Requirements
- λ¬Έμ„ μ „λ°μ— κ±Έμ³ μ†κ°λλ” μ§€μΉ¨κ³Ό μ°Έκ³  μ‚¬ν•­μ„ λ¨λ‘ μ™μ§€ν•΄μ•Ό ν•λ©°, λ³„λ„μ μ¶”κ°€ μ„ ν–‰ μ΅°κ±΄μ€ μ›λ¬Έ κ° μ μ—μ„ μ μ‹λλ” λ‚΄μ©μ„ λ”°λ¦…λ‹λ‹¤.

## Workflow
1. μ•„λ `## Detail Items` μ μ— ν¬ν•¨λ μ›λ¬Έ λ©μ°¨λ¥Ό κ²€ν† ν•©λ‹λ‹¤.
2. ν•„μ”ν• κ²½μ° μ›λ¬Έμ κ° μ μ„ μμ„λ€λ΅ μ½μΌλ©° ν”„λ΅μ νΈ μ‘μ—… νλ¦„μ— λ°μν•©λ‹λ‹¤.
3. λ¬Έμ„μ— λ…μ‹λ λ¨λ“  μ§€μΉ¨μ„ ν™•μΈν• λ’¤ μ‹¤μ  κ°λ° λ‹¨κ³„μ— μ μ©ν•©λ‹λ‹¤.

## Detail Items
- μ΄ν•μ—λ” κΈ°μ΅΄ λ¬Έμ„μ λ¨λ“  λ‚΄μ©μ„ μ›ν• κ·Έλ€λ΅ ν¬ν•¨ν•μ—¬ μ°Έμ΅°ν•  μ μλ„λ΅ κµ¬μ„±ν–μµλ‹λ‹¤.

# Firebase Realtime Database κµ¬μ΅° κ°€μ΄λ“

λ³Έ λ¬Έμ„λ” SNS μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ Firebase Realtime Database μ¤ν‚¤λ§ μ •μλ¥Ό μ κ³µν•©λ‹λ‹¤.
κ° κΈ°λ¥μ μƒμ„Έν• κµ¬ν„ λ°©λ²•μ€ ν•΄λ‹Ή κ°€μ΄λ“ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”.

## μ›ν¬ν”λ΅μ°

### π“‹ λ¬Έμ„μ λ²”μ„

λ³Έ λ¬Έμ„λ” **λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ΅°(μ¤ν‚¤λ§)μ™€ κµ¬μ΅°μ— λ€ν• μ„¤λ…λ§** ν¬ν•¨ν•©λ‹λ‹¤.

- β… **ν¬ν•¨λλ” λ‚΄μ©**:
  - Firebase Realtime Database κ²½λ΅ λ° κµ¬μ΅° μ •μ
  - κ° ν•„λ“μ νƒ€μ… λ° μ„¤λ…
  - λ°μ΄ν„° κµ¬μ΅° μμ‹
  - ν΄λΌμ΄μ–ΈνΈ/λ°±μ—”λ“ μ—­ν•  κµ¬λ¶„ (μ–΄λ–¤ ν•„λ“λ¥Ό λ„κ°€ μ €μ¥ν•λ”μ§€)

- β **ν¬ν•¨λμ§€ μ•λ” λ‚΄μ©**:
  - κµ¬μ²΄μ μΈ κµ¬ν„ μ½”λ“ μμ  (TypeScript, JavaScript)
  - μΌ€μ΄μ¤λ³„ μƒμ„Έ μ„¤λ… λ° μ‚¬μ© μμ‹
  - API ν•¨μ μ‚¬μ©λ²•

**κµ¬ν„ μμ μ™€ μƒμ„Έ μ„¤λ…**μ€ λ‹¤μ κ°λ³„ κ°€μ΄λ“ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”:
- [Firebase Cloud Functions κ°λ° κ°€μ΄λ“](./sns-firebase-cloud-functions.md) - Cloud Functions κµ¬ν„ μμ 

### π”€ ν΄λΌμ΄μ–ΈνΈμ™€ λ°±μ—”λ“μ λ°μ΄ν„° μ±…μ„ κµ¬λ¶„

**λ§¤μ° μ¤‘μ”**: DB κµ¬μ΅°μ κ° ν•„λ“λ” **ν΄λΌμ΄μ–ΈνΈκ°€ μ €μ¥**ν•κ±°λ‚ **λ°±μ—”λ“κ°€ μ—…λ°μ΄νΈ**ν•λ„λ΅ λ…ν™•ν κµ¬λ¶„λμ–΄ μμµλ‹λ‹¤.

| ν•„λ“ μ ν• | μ±…μ„ μ£Όμ²΄ | μμ‹ ν•„λ“ |
|----------|---------|----------|
| **μ‚¬μ©μ μ…λ ¥ λ°μ΄ν„°** | ν΄λΌμ΄μ–ΈνΈλ§ μ €μ¥ | `title`, `content`, `uid`, `createdAt` |
| **μΉ΄μ΄ν„° ν•„λ“** | λ°±μ—”λ“λ§ μ—…λ°μ΄νΈ | `likeCount`, `commentCount`, `postCount` |
| **ν†µκ³„ λ° μ§‘κ³„** | λ°±μ—”λ“λ§ μ—…λ°μ΄νΈ | `/stats/counters/*`, `/categories/{category}/postCount` |
| **μ†μ„± λ¶„λ¦¬ λ°μ΄ν„°** | λ°±μ—”λ“λ§ λ™κΈ°ν™” | `/user-props/displayName/{uid}` |

β οΈ **κ°λ° μ‹ ν•„μ μ¤€μ μ‚¬ν•­**:
- ν΄λΌμ΄μ–ΈνΈλ” **μ λ€λ΅** μΉ΄μ΄ν„° ν•„λ“λ¥Ό μ§μ ‘ μ¦κ°€/κ°μ†μ‹ν‚¤μ§€ μ•μµλ‹λ‹¤
- ν΄λΌμ΄μ–ΈνΈλ” **μ λ€λ΅** ν†µκ³„ λ°μ΄ν„°λ¥Ό μ§μ ‘ κ³„μ‚°ν•μ—¬ μ €μ¥ν•μ§€ μ•μµλ‹λ‹¤
- λ°±μ—”λ“(Cloud Functions)λ§μ΄ μΉ΄μ΄ν„°, ν†µκ³„, μ†μ„± λ¶„λ¦¬ μ‘μ—…μ„ μν–‰ν•©λ‹λ‹¤

**β οΈ μ¤‘μ” μ›μΉ™**: μ›Ή/μ•± ν΄λΌμ΄μ–ΈνΈμ—μ„λ” **μµμ†ν•μ μ •λ³΄λ§ RTDBμ— κΈ°λ΅**ν•κ³ , **μ¶”κ°€μ μΈ μ •λ³΄ μ—…λ°μ΄νΈλ” Firebase Cloud Functions λ°±μ—”λ“μ—μ„ μ²λ¦¬**ν•©λ‹λ‹¤.

### ν΄λΌμ΄μ–ΈνΈμ™€ λ°±μ—”λ“μ μ—­ν•  λ¶„λ¦¬

**ν΄λΌμ΄μ–ΈνΈμ μ—­ν•  (μµμ†ν•μ λ°μ΄ν„°λ§ μ €μ¥):**
- β… μ‚¬μ©μκ°€ μ§μ ‘ μ…λ ¥ν• λ°μ΄ν„°λ§ RTDBμ— μ €μ¥ν•©λ‹λ‹¤ (μ: κ²μ‹κΈ€ μ λ©, λ‚΄μ©, λ“κΈ€ λ‚΄μ©)
- β… κΈ°λ³Έμ μΈ λ©”νƒ€λ°μ΄ν„°λ§ ν¬ν•¨ν•©λ‹λ‹¤ (μ: uid, createdAt, category)
- β μΉ΄μ΄ν„° μ¦κ°€/κ°μ†λ¥Ό μ§μ ‘ μ²λ¦¬ν•μ§€ μ•μµλ‹λ‹¤ (μ: likeCount, commentCount)
- β λ°μ΄ν„° μ§‘κ³„ λ° ν†µκ³„λ¥Ό μ§μ ‘ κ³„μ‚°ν•μ§€ μ•μµλ‹λ‹¤ (μ: stats/counters, categories)
- β μ†μ„± λ¶„λ¦¬ μ‘μ—…μ„ μ§μ ‘ ν•μ§€ μ•μµλ‹λ‹¤ (μ: user-props/)

**λ°±μ—”λ“(Cloud Functions)μ μ—­ν•  (μλ™ λ°μ΄ν„° μ²λ¦¬):**
- β… ν΄λΌμ΄μ–ΈνΈκ°€ μ €μ¥ν• λ°μ΄ν„°λ¥Ό κ°μ§€ν•μ—¬ μ¶”κ°€ λ°μ΄ν„°λ¥Ό μλ™μΌλ΅ μ—…λ°μ΄νΈν•©λ‹λ‹¤
- β… μΉ΄μ΄ν„° μλ™ μ¦κ°€/κ°μ† (μ: likeCount, commentCount, postCount)
- β… μ „μ²΄ ν†µκ³„ μλ™ μ§‘κ³„ (μ: stats/counters/like, stats/counters/post)
- β… μ‚¬μ©μ μ†μ„± λ¶„λ¦¬ μλ™ λ™κΈ°ν™” (μ: /users/{uid} β†’ /user-props/displayName/{uid})
- β… λ°μ΄ν„° λ¬΄κ²°μ„± λ³΄μ¥ (μ: κ²μ‹κΈ€ μ‚­μ  μ‹ κ΄€λ ¨ λ“κΈ€/μΆ‹μ•„μ” μ •λ¦¬)

**κµ¬μ²΄μ μΈ μμ‹**λ” λ‹¤μ κ°€μ΄λ“ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”:
- [Firebase Cloud Functions κ°λ° κ°€μ΄λ“](./sns-firebase-cloud-functions.md)

μ΄λ¬ν• μ—­ν•  λ¶„λ¦¬λ¥Ό ν†µν•΄ λ‹¤μκ³Ό κ°™μ€ μ΄μ μ„ μ–»μ„ μ μμµλ‹λ‹¤:
- π”’ **λ°μ΄ν„° λ¬΄κ²°μ„±**: λ°±μ—”λ“μ—μ„ μΌκ΄€λκ² μ²λ¦¬ν•μ—¬ μ¤‘λ³µ μ¦κ°€/κ°μ† λ°©μ§€
- β΅ **μ„±λ¥ μµμ ν™”**: ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μ μ‘μ—…λ§ μν–‰ν•μ—¬ λΉ λ¥Έ μ‘λ‹µ
- π”§ **μ μ§€λ³΄μμ„±**: λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ λ°±μ—”λ“μ— μ§‘μ¤‘λμ–΄ κ΄€λ¦¬ μ©μ΄
- π **ν”λ«νΌ λ…λ¦½μ„±**: μ›Ή/μ•± λ¨λ‘ λ™μΌν• λ°±μ—”λ“ λ΅μ§ κ³µμ 


---

## κ°μ”

- Firebase Realtime Database(RTDB)λ” μ‹¤μ‹κ°„ λ°μ΄ν„° λ™κΈ°ν™”κ°€ ν•„μ”ν• SNS μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ— μ ν•©ν•©λ‹λ‹¤.
- λ°μ΄ν„°λ” **flat style** κµ¬μ΅°λ΅ μ €μ¥λμ–΄ μΏΌλ¦¬ ν¨μ¨μ„±μ„ κ·Ήλ€ν™”ν•©λ‹λ‹¤.
- μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„λ” ν•„μ”ν• μµμ†ν•μ λ°μ΄ν„°λ§ μ €μ¥ν•κ³ , Firebase Cloud Functionsλ¥Ό μ‚¬μ©ν•μ—¬ λ³µμ΅ν• λ°μ΄ν„° μ²λ¦¬ λ° μ§‘κ³„λ¥Ό μν–‰ν•©λ‹λ‹¤.

---

## λ°μ΄ν„°λ² μ΄μ¤ μ „μ²΄ κµ¬μ΅°

```
Firebase Realtime Database (λ£¨νΈ)
β”β”€β”€ users/                    # μ‚¬μ©μ ν”„λ΅ν•„
β”β”€β”€ user-props/               # μ‚¬μ©μ μ†μ„± (λ€λ‰ μΏΌλ¦¬ μµμ ν™”)
β”β”€β”€ friends/                  # μΉκµ¬ κ΄€κ³„
β”β”€β”€ followers/                # ν”λ΅μ› (λ‚λ¥Ό ν”λ΅μ°ν•λ” μ‚¬μ©μ)
β””β”€β”€ following/                # ν”λ΅μ‰ (λ‚΄κ°€ ν”λ΅μ°ν•λ” μ‚¬μ©μ)
```

---

## μ‚¬μ©μ μ •λ³΄ (users)

μ‚¬μ©μ ν”„λ΅ν•„ μ •λ³΄λ” `/users/<uid>/` κ²½λ΅μ— μ €μ¥λ©λ‹λ‹¤.

### μ‚¬μ©μ Realtime Database λ°μ΄ν„° κµ¬μ΅°


μ‚¬μ©μ ν”„λ΅ν•„ λ°μ΄ν„°μ μ €μ¥ κµ¬μ΅°λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

```
/users/
β”β”€β”€ <uid1>/
β”‚   β”β”€β”€ displayName: "μ‚¬μ©μ1"
β”‚   β”β”€β”€ photoUrl: "https://firebasestorage.googleapis.com/..."
β”‚   β”β”€β”€ gender: "M"
β”‚   β”β”€β”€ birthYear: 1990
β”‚   β”β”€β”€ birthMonth: 1
β”‚   β”β”€β”€ birthDay: 15
β”‚   β”β”€β”€ bio: "μκΈ°μ†κ°"
β”‚   β”β”€β”€ createdAt: 1698473000000
β”‚   β””β”€β”€ updatedAt: 1698474000000
β””β”€β”€ <uid2>/
    β”β”€β”€ displayName: "μ‚¬μ©μ2"
    β”β”€β”€ photoUrl: null
    β”β”€β”€ gender: "F"
    β”β”€β”€ createdAt: 1698473100000
    β””β”€β”€ updatedAt: 1698474100000
```

### ν•„λ“ μ„¤λ…

| ν•„λ“ | νƒ€μ… | ν•„μ | μ„¤λ… |
|------|------|------|------|
| `displayName` | string | β… | μ‚¬μ©μ λ‹‰λ„¤μ„ |
| `photoUrl` | string | β | ν”„λ΅ν•„ μ‚¬μ§„ URL |
| `gender` | (M|F) | β | μ„±λ³„ |
| `birthYear` | number | β | μƒλ…„ |
| `birthMonth` | number | β | μƒμ›” |
| `birthDay` | number | β | μƒμΌ |
| `bio` | string | β | μκΈ°μ†κ° |
| `createdAt` | number | β… | κ³„μ • μƒμ„± μ‹κ°„ |
| `updatedAt` | number | β… | ν”„λ΅ν•„ μμ • μ‹κ°„ |

### ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—­ν•  λ¶„λ¦¬

μ‚¬μ©μ μ •λ³΄μ κ²½μ°:
- **ν΄λΌμ΄μ–ΈνΈλ”** `displayName`, `photoUrl`, `gender`, `birthYear`, `birthMonth`, `birthDay`, `bio` λ¥Ό μ €μ¥ν•  μ μκ³ ,
- **μ„λ²„λ”** `createdAt` κ³Ό `updatedAt` λ§ μ €μ¥ν•  μ μμµλ‹λ‹¤.

### β οΈ μ¤‘μ”: Firebase Auth vs RTDB ν•„λ“

**/users/<uid> λ…Έλ“μ—λ” Firebase Auth μ •λ³΄λ¥Ό μ €μ¥ν•μ§€ μ•μµλ‹λ‹¤:**

Firebase Authenticationμ λ‹¤μ ν•„λ“λ“¤μ€ `/users/<uid>` λ…Έλ“μ— **μ €μ¥ν•μ§€ μ•μµλ‹λ‹¤**:
- β `phoneNumber` - Firebase Authμ—μ„λ§ κ΄€λ¦¬
- β `email` - Firebase Authμ—μ„λ§ κ΄€λ¦¬
- β `photoURL` (λ€λ¬Έμ URL) - Firebase Authμ—μ„λ§ κ΄€λ¦¬

μ΄λ“¤ μ •λ³΄λ” `login` μΈμ¤ν„΄μ¤λ¥Ό ν†µν•΄ μ ‘κ·Όν•  μ μμµλ‹λ‹¤. μμ„Έν• μ‚¬μ©λ²•μ€ [μ½”λ”© κ°€μ΄λ“λΌμΈ - Firebase λ΅κ·ΈμΈ μ‚¬μ©μ κ΄€λ¦¬](./sns-web-coding-guideline.md#firebase-λ΅κ·ΈμΈ-μ‚¬μ©μ-κ΄€λ¦¬-login)λ¥Ό μ°Έκ³ ν•μ„Έμ”.

**λ‹¨, `photoUrl`(camelCase)μ€ μμ™Έμ…λ‹λ‹¤:**

- β… **`photoUrl`** (camelCase) - μ‚¬μ©μκ°€ μ§μ ‘ μ—…λ΅λ“ν• ν”„λ΅ν•„ μ‚¬μ§„ URLμ„ RTDBμ— μ €μ¥
- μ΄λ” Firebase Authμ `photoURL`(λ€λ¬Έμ)κ³Ό **λ‹¤λ¥Έ ν•„λ“**μ…λ‹λ‹¤
- μ‚¬μ©μκ°€ Firebase Storageμ— μ‚¬μ§„μ„ μ—…λ΅λ“ν•λ©΄, λ‹¤μ΄λ΅λ“ URLμ„ `/users/<uid>/photoUrl`μ— μ €μ¥ν•©λ‹λ‹¤

**ν•„λ“λ… μ°¨μ΄ μ”μ•½:**

| ν•„λ“ | μ„μΉ | μ„¤λ… |
|------|------|------|
| `phoneNumber` | Firebase Auth | μ „ν™”λ²νΈ (login.phoneNumberλ΅ μ ‘κ·Ό) |
| `email` | Firebase Auth | μ΄λ©”μΌ (login.emailλ΅ μ ‘κ·Ό) |
| `photoURL` (λ€λ¬Έμ) | Firebase Auth | Firebase Auth ν”„λ΅ν•„ μ‚¬μ§„ |
| `photoUrl` (camelCase) | RTDB | μ‚¬μ©μ μ—…λ΅λ“ ν”„λ΅ν•„ μ‚¬μ§„ (login.data.photoUrlλ΅ μ ‘κ·Ό) |

μμ„Έν• λ‚΄μ©μ€ [μ‚¬μ©μ κ΄€λ¦¬ κ°λ° κ°€μ΄λ“](./sns-web-user.md)μ™€ [μ½”λ”© κ°€μ΄λ“λΌμΈ](./sns-web-coding-guideline.md#firebase-λ΅κ·ΈμΈ-μ‚¬μ©μ-κ΄€λ¦¬-login)μ„ μ°Έκ³ ν•μ„Έμ”.

### κ΄€λ ¨ κ°€μ΄λ“

- **π“– κµ¬ν„ κ°€μ΄λ“**: [μ‚¬μ©μ κ΄€λ¦¬ κ°λ° κ°€μ΄λ“](./sns-web-user.md) - ν”„λ΅ν•„ κ΄€λ¦¬, ν”„λ΅ν•„ μ‚¬μ§„ μ—…λ΅λ“, μ‚¬μ©μ μ •λ³΄ μ΅°ν
- **π“– νμΌ μ—…λ΅λ“**: [νμΌ λ° μ‚¬μ§„ μ—…λ΅λ“ κ°€μ΄λ“](./sns-web-storage.md) - ν”„λ΅ν•„ μ‚¬μ§„ Firebase Storage μ—…λ΅λ“
- **π“– λ³΄μ•**: [Firebase λ³΄μ• κ·μΉ™ κ°λ° κ°€μ΄λ“](./sns-web-security.md) - μ‚¬μ©μ ν”„λ΅ν•„ μ ‘κ·Ό μ μ–΄

---

## μ‚¬μ©μ μ†μ„± λ¶„λ¦¬ (user-props)

νΉμ • μ†μ„±μ— λ€ν• λ€λ‰ μ΅°νλ¥Ό ν¨μ¨μ μΌλ΅ μν–‰ν•κΈ° μ„ν•΄ μ‚¬μ©μ μ†μ„±μ„ λ³„λ„λ΅ κ΄€λ¦¬ν•©λ‹λ‹¤.

### λ°μ΄ν„° κµ¬μ΅°

```
/user-props/
  /displayName/
    β”β”€β”€ <uid1>: "μ‚¬μ©μ1"
    β”β”€β”€ <uid2>: "μ‚¬μ©μ2"
    β””β”€β”€ <uid3>: "μ‚¬μ©μ3"
  /photoUrl/
    β”β”€β”€ <uid1>: "https://..."
    β”β”€β”€ <uid2>: null
    β””β”€β”€ <uid3>: "https://..."
  /createdAt/
    β”β”€β”€ <uid1>: 1698473000000
    β”β”€β”€ <uid2>: 1698473100000
    β””β”€β”€ <uid3>: 1698473200000
  /updatedAt/
    β”β”€β”€ <uid1>: 1698474000000
    β”β”€β”€ <uid2>: 1698474100000
    β””β”€β”€ <uid3>: 1698474200000
```

### ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—­ν•  λ¶„λ¦¬

μ‚¬μ©μ μ†μ„± λ¶„λ¦¬μ κ²½μ°:
- **ν΄λΌμ΄μ–ΈνΈλ”** μ§μ ‘ μ €μ¥ν•μ§€ μ•μΌλ©°, `/users/<uid>` λ…Έλ“μ ν•„λ“λ¥Ό μμ •ν•©λ‹λ‹¤.
- **μ„λ²„λ”** `/users/<uid>` λ…Έλ“μ λ³€κ²½μ„ κ°μ§€ν•μ—¬ `/user-props/displayName/<uid>`, `/user-props/photoUrl/<uid>` λ“±μ ν•„λ“λ¥Ό μλ™μΌλ΅ λ™κΈ°ν™”ν•©λ‹λ‹¤. (Cloud Functions)

### κ΄€λ ¨ κ°€μ΄λ“

- **π“– κµ¬ν„ κ°€μ΄λ“**: [μ‚¬μ©μ κ΄€λ¦¬ κ°λ° κ°€μ΄λ“ - μ‚¬μ©μ μ†μ„± λ¶„λ¦¬](./sns-web-user.md#μ‚¬μ©μ-μ†μ„±-λ¶„λ¦¬-user-props) - μ†μ„± λ¶„λ¦¬ μ „λµ, ν¨μ¨μ μΈ λ€λ‰ μ΅°ν λ°©λ²•

---

## μΉκµ¬ κ΄€κ³„ (friends, followers, following)

μ‚¬μ©μ κ°„μ κ΄€κ³„λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.

### λ°μ΄ν„° κµ¬μ΅°

```
/friends/
  <uid>/
    β”β”€β”€ <other-uid1>: 1698473000000
    β”β”€β”€ <other-uid2>: 1698473100000
    β””β”€β”€ ...

/followers/
  <uid>/
    β”β”€β”€ <follower-uid1>: 1698473000000
    β””β”€β”€ ...

/following/
  <uid>/
    β”β”€β”€ <following-uid1>: 1698473000000
    β””β”€β”€ ...
```

### μ„¤λ…

- **friends**: μƒνΈ μΉκµ¬ κ΄€κ³„ (μ–‘λ°©ν–¥)
- **followers**: λ‚λ¥Ό ν”λ΅μ°ν•λ” μ‚¬μ©μ (λ‹¨λ°©ν–¥ μμ‹ )
- **following**: λ‚΄κ°€ ν”λ΅μ°ν•λ” μ‚¬μ©μ (λ‹¨λ°©ν–¥ λ°μ‹ )
- κ° κ°’μ€ κ΄€κ³„ ν•μ„± μ‹κ°„ (Unix timestamp, λ°€λ¦¬μ΄)

### ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—­ν•  λ¶„λ¦¬

μΉκµ¬ κ΄€κ³„μ κ²½μ°:
- **ν΄λΌμ΄μ–ΈνΈλ”** `/friends/<uid>/<other-uid>`, `/followers/<uid>/<follower-uid>`, `/following/<uid>/<following-uid>` λ…Έλ“λ¥Ό μ¶”κ°€/μ‚­μ ν•μ—¬ μΉκµ¬ κ΄€κ³„λ¥Ό μ”μ²­ν•  μ μκ³ ,
- **μ„λ²„λ”** μΉκµ¬ μ¶”κ°€/μ‚­μ  μ‹ μ–‘λ°©ν–¥ κ΄€κ³„ λ™κΈ°ν™”λ¥Ό μλ™μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤. (Cloud Functions)
  - μ: Aκ°€ Bλ¥Ό ν”λ΅μ°ν•λ©΄ `/following/<A-uid>/<B-uid>`μ™€ `/followers/<B-uid>/<A-uid>`κ°€ λ¨λ‘ μ—…λ°μ΄νΈλ¨

### κ΄€λ ¨ κ°€μ΄λ“

- **π“– κµ¬ν„ κ°€μ΄λ“**: [μΉκµ¬ κ΄€κ³„ κ΄€λ¦¬ κ°λ° κ°€μ΄λ“](./sns-web-friends.md) - μΉκµ¬ μ¶”κ°€, ν”λ΅μ°, μ–Έν”λ΅μ°, μΉκµ¬ λ©λ΅ μ΅°ν
- **π“– μ‚¬μ©μ μ •λ³΄**: [μ‚¬μ©μ κ΄€λ¦¬ κ°λ° κ°€μ΄λ“](./sns-web-user.md) - μ‚¬μ©μ ν”„λ΅ν•„ μ΅°ν, κΈ°λ³Έ μ •λ³΄
- **π“– λ³΄μ• κ·μΉ™**: [Firebase λ³΄μ• κ·μΉ™ κ°λ° κ°€μ΄λ“](./sns-web-security.md) - μΉκµ¬ κ΄€κ³„ μ ‘κ·Ό μ μ–΄

---

## μ£Όμ” μ„¤κ³„ μ›μΉ™

### 1. Flat Style κµ¬μ΅°

- λ°μ΄ν„°λ¥Ό λ‹¨μν•κ³  ν‰νƒ„ν• κµ¬μ΅°λ΅ μ €μ¥
- λ³µμ΅ν• λ‹¤λ‹¨κ³„ λ…Έλ“ κµ¬μ΅° νν”Ό
- μΏΌλ¦¬ ν¨μ¨μ„±κ³Ό μ„±λ¥ κ·Ήλ€ν™”

### 2. μ†μ„± λ¶„λ¦¬

- νΉμ • μ†μ„±μ— λ€ν• λ€λ‰ μ΅°νκ°€ ν•„μ”ν• κ²½μ° λ³„λ„ κ²½λ΅μ—μ„ κ΄€λ¦¬
- μ: `user-props/displayName`
- λ„¤νΈμ›ν¬ μµμ ν™” λ° μΏΌλ¦¬ μ„±λ¥ ν–¥μƒ

### 3. Cloud Functions ν™μ©

ν΄λΌμ΄μ–ΈνΈμ™€ λ°±μ—”λ“μ μ—­ν• μ„ λ…ν™•ν λ¶„λ¦¬ν•μ—¬ λ°μ΄ν„° λ¬΄κ²°μ„±κ³Ό μ„±λ¥μ„ λ³΄μ¥ν•©λ‹λ‹¤.

**μ›μΉ™:**
- β… **ν΄λΌμ΄μ–ΈνΈλ” μµμ†ν•μ λ°μ΄ν„°λ§ RTDBμ— κΈ°λ΅**
  - μ‚¬μ©μκ°€ μ§μ ‘ μ…λ ¥ν• λ°μ΄ν„° (κ²μ‹κΈ€, λ“κΈ€ λ‚΄μ© λ“±)
  - κΈ°λ³Έ λ©”νƒ€λ°μ΄ν„° (uid, createdAt, category)
- β… **λ°±μ—”λ“(Cloud Functions)λ” μ¶”κ°€ λ°μ΄ν„° μλ™ μ²λ¦¬**
  - μΉ΄μ΄ν„° μλ™ μ¦κ°€/κ°μ† (likeCount, commentCount, postCount)
  - μ „μ²΄ ν†µκ³„ μλ™ μ§‘κ³„ (stats/counters)
  - μ‚¬μ©μ μ†μ„± λ¶„λ¦¬ μλ™ λ™κΈ°ν™” (user-props)
  - λ°μ΄ν„° λ¬΄κ²°μ„± λ³΄μ¥

**ν΄λΌμ΄μ–ΈνΈμ—μ„ ν•μ§€ λ§μ•„μ•Ό ν•  μ‘μ—…:**
- β μΉ΄μ΄ν„° μ§μ ‘ μ¦κ°€/κ°μ† (`increment()` μ‚¬μ© κΈμ§€)
- β λ°μ΄ν„° μ§‘κ³„ λ° ν†µκ³„ μ§μ ‘ κ³„μ‚°
- β μ†μ„± λ¶„λ¦¬ μ‘μ—… μ§μ ‘ μν–‰
- β λ³µμ΅ν• λΉ„μ¦λ‹μ¤ λ΅μ§ μ²λ¦¬

**κµ¬μ²΄μ μΈ μμ‹μ™€ κµ¬ν„ λ°©λ²•μ€ κ° κΈ°λ¥λ³„ κ°λ° κ°€μ΄λ“ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”:**
- [Firebase Cloud Functions κ°λ° κ°€μ΄λ“](./sns-firebase-cloud-functions.md) - λ°±μ—”λ“ λ΅μ§ κµ¬ν„ μƒμ„Έ κ°€μ΄λ“

### 4. λ³΄μ• κ·μΉ™

- Firebase Security Rulesλ΅ μ ‘κ·Ό κ¶ν• μ μ–΄
- κ° λ°μ΄ν„° μ„Ήμ…λ³„λ΅ μ½κΈ°/μ“°κΈ° κ¶ν• μ •μ
- λ°μ΄ν„° κ²€μ¦ κ·μΉ™ ν¬ν•¨

---

## μ£Όμμ‚¬ν•­

### Firebase Auth vs RTDB ν•„λ“λ… μ°¨μ΄

**ν”„λ΅ν•„ μ‚¬μ§„ ν•„λ“λ…μ΄ λ‹¤λ¦…λ‹λ‹¤:**
- **Firebase Auth**: `photoURL` (λ€λ¬Έμ URL)
- **RTDB**: `photoUrl` (camelCase url)

μμ„Έν• λ‚΄μ©κ³Ό κµ¬ν„ μμ λ” [μ‚¬μ©μ κ΄€λ¦¬ κ°λ° κ°€μ΄λ“](./sns-web-user.md) λ° [μ½”λ”© κ°€μ΄λ“λΌμΈ - Firebase Auth vs RTDB ν•„λ“λ… μ°¨μ΄](../CLAUDE.md#firebase-auth-vs-rtdb-ν•„λ“λ…-μ°¨μ΄-λ§¤μ°-μ¤‘μ”)λ¥Ό μ°Έκ³ ν•μ„Έμ”.

---

## κ΄€λ ¨ κ°€μ΄λ“ λ¬Έμ„

μ „μ²΄ λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ΅°μ™€ κ΄€λ ¨λ μƒμ„Έν• κ°λ° κ°€μ΄λ“:

- **[μ‚¬μ©μ κ΄€λ¦¬](./sns-web-user.md)** - μ‚¬μ©μ ν”„λ΅ν•„, μ†μ„± λ¶„λ¦¬, Cloud Functions
- **[μΉκµ¬ κ΄€κ³„](./sns-web-friends.md)** - μΉκµ¬, ν”λ΅μ°, ν”λ΅μ› κ΄€λ¦¬
- **[Firebase λ³΄μ•](./sns-web-security.md)** - λ³΄μ• κ·μΉ™ μ„¤μ •

---

## μ°Έκ³  μλ£

- [Firebase Realtime Database κ³µμ‹ λ¬Έμ„](https://firebase.google.com/docs/database)
- [Firebase Security Rules κ³µμ‹ λ¬Έμ„](https://firebase.google.com/docs/rules)
- [Firebase Cloud Functions κ³µμ‹ λ¬Έμ„](https://firebase.google.com/docs/functions)
