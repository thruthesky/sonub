---
title: i18n.ts
type: typescript
path: firebase/functions/src/i18n.ts
status: active
version: 1.0.0
last_updated: 2025-11-15
---

## 개요

이 파일은 `firebase/functions/src/i18n.ts`의 소스 코드를 포함하는 SED 스펙 문서입니다.

## 소스 코드

```typescript
/**
 * Firebase Cloud Functions용 다국어(i18n) 시스템
 *
 * 지원 언어:
 * - en: 영어
 * - ko: 한국어
 * - ja: 일본어
 * - zh: 중국어 (간체)
 *
 * 사용 예시:
 * ```typescript
 * const message = t("ko", "chatInvitation.title");
 * // 결과: "채팅 초대"
 *
 * const body = t("ko", "chatInvitation.body", {
 *   inviterName: "철수",
 *   roomName: "팀 회의방"
 * });
 * // 결과: "철수님이 팀 회의방에 초대하였습니다."
 * ```
 */

/**
 * 지원하는 언어 코드 타입
 */
export type LanguageCode = "en" | "ko" | "ja" | "zh";

/**
 * 기본 언어 코드
 */
export const DEFAULT_LANGUAGE: LanguageCode = "en";

/**
 * 번역 메시지 타입
 */
type TranslationKey = string;
type TranslationValue = string;
type TranslationMap = Record<TranslationKey, TranslationValue>;

/**
 * 다국어 메시지 데이터베이스
 *
 * 주요 메시지:
 * - chatInvitation.*: 채팅 초대 관련 메시지
 */
const translations: Record<LanguageCode, TranslationMap> = {
  en: {
    // 채팅 초대
    "chatInvitation.title": "Chat Invitation",
    "chatInvitation.body": "{inviterName} invited you to {roomName}",
    "chatInvitation.message": "{inviterName} invited you to {roomName}",
  },
  ko: {
    // 채팅 초대
    "chatInvitation.title": "채팅 초대",
    "chatInvitation.body": "{inviterName}님이 {roomName}에 초대하였습니다.",
    "chatInvitation.message": "{inviterName}님이 {roomName} 채팅방에 초대하였습니다.",
  },
  ja: {
    // 채팅 초대
    "chatInvitation.title": "チャット招待",
    "chatInvitation.body": "{inviterName}さんが{roomName}に招待しました。",
    "chatInvitation.message": "{inviterName}さんが{roomName}チャットルームに招待しました。",
  },
  zh: {
    // 채팅 초대
    "chatInvitation.title": "聊天邀请",
    "chatInvitation.body": "{inviterName}邀请您加入{roomName}",
    "chatInvitation.message": "{inviterName}邀请您加入{roomName}聊天室",
  },
};

/**
 * 번역 함수
 *
 * @param languageCode - 언어 코드 (en, ko, ja, zh)
 * @param key - 번역 키 (예: "chatInvitation.title")
 * @param params - 치환할 파라미터 (선택 사항)
 * @returns 번역된 메시지
 *
 * @example
 * ```typescript
 * // 단순 번역
 * const title = t("ko", "chatInvitation.title");
 * // "채팅 초대"
 *
 * // 파라미터 치환
 * const body = t("ko", "chatInvitation.body", {
 *   inviterName: "철수",
 *   roomName: "팀 회의방"
 * });
 * // "철수님이 팀 회의방에 초대하였습니다."
 * ```
 */
export function t(
  languageCode: string | null | undefined,
  key: TranslationKey,
  params?: Record<string, string>
): string {
  // 언어 코드 검증 및 기본값 처리
  const lang = isValidLanguageCode(languageCode) ? languageCode : DEFAULT_LANGUAGE;

  // 번역 메시지 가져오기
  const translation = translations[lang]?.[key];

  // 번역이 없으면 영어(기본값) 사용
  if (!translation) {
    const fallback = translations[DEFAULT_LANGUAGE]?.[key];
    if (!fallback) {
      // 영어도 없으면 키 그대로 반환
      return key;
    }
    return replacePlaceholders(fallback, params);
  }

  // 파라미터 치환
  return replacePlaceholders(translation, params);
}

/**
 * 언어 코드가 유효한지 검증
 *
 * @param code - 검증할 언어 코드
 * @returns 유효하면 true, 아니면 false
 */
function isValidLanguageCode(code: string | null | undefined): code is LanguageCode {
  if (!code) return false;
  return ["en", "ko", "ja", "zh"].includes(code);
}

/**
 * 메시지 내의 플레이스홀더를 파라미터 값으로 치환
 *
 * 플레이스홀더 형식: {paramName}
 *
 * @param message - 원본 메시지
 * @param params - 치환할 파라미터
 * @returns 치환된 메시지
 *
 * @example
 * ```typescript
 * const result = replacePlaceholders(
 *   "{name}님이 {room}에 초대하였습니다.",
 *   { name: "철수", room: "회의방" }
 * );
 * // "철수님이 회의방에 초대하였습니다."
 * ```
 */
function replacePlaceholders(
  message: string,
  params?: Record<string, string>
): string {
  if (!params) {
    return message;
  }

  let result = message;
  for (const [key, value] of Object.entries(params)) {
    const placeholder = `{${key}}`;
    result = result.replace(new RegExp(placeholder, "g"), value);
  }

  return result;
}

```

## 변경 이력

- 2025-11-15: 스펙 문서 생성
